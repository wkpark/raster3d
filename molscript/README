To use Molscript as an input driver for Raster3D you first need to
obtain a copy of Molscript version 1.4 from Per Kraulis.  
Earlier versions of Molscript supported only a very limited interface to
Raster3D (basically just CPK models).

Molscript is subject to license control. Please make sure that you have
registered a license agreement. If you need to contact Per Kraulis, the
most recent Email address I have is:      krpx@sgikrpe.sto.se.pnu.com

This directory contains two subroutines which can be used to patch Molscript
version 1.4 to improve the interface to Raster3D.

	raspln.f - a replacement for the RASPLN subroutine in the 
		   distributed version of graphics.f
	grlind.f - an additional routine to be added to the
		   distributed version of graphics.f
	graphics.f - a patched version of the Molscript V1.4 graphics.f
		   with the new RASPLN and GRLIND already added.

The routine RASPLN (file raspln.f) replaces an older version of the same
routine in the Molscript source file graphics.f.  
The older version could produce odd results near the edges of a helix,
particularly if the Molscript "segments" parameter was too small. 
The new version is much more forgiving.
The new version also contains code to render all sides of a helix,
rather than just the front (visible) surface.  I hope that this code
will be selectable as an option in some future version of Molscript
(e.g. "set helixsolid = yes"), but for now it is by default disabled.

The routine GRLIND (file grlind.f) also needs to be inserted into the
Molscript source file graphics.f.  You must also edit a couple of other 
lines in graphics.f as described in step 4 below.
These changes will allow Molscript to output dotted lines in Raster3D mode.

=============================================================================
Step by step instructions:

1) Go to your Molscript source directory

2) Make a backup copy of the original Molscript source files graphics.f

3) If you have made no local changes to the Molscript V1.4 version
   of graphics.f, you can just copy the new version from the
   Raster3D distribution into the Molscript source directory and
   skip to step 5.

4) If you have an already altered version of graphics.f and want to
   apply the Raster3D fixes on top of your local modifications, then
   use the source code in raspln.f and grlind.f
   (a)	Replace the routine RASPLN with the contents of the file raspln.f 
	from the Raster3D distribution.
   (b)	Insert the file grlind.f into the graphics.f source file.
   (c)	Find SUBROUTINE GRLINE in the graphics.f source file.
	Just *before* the line (should be line 516)
		C Ignore if entirely outside of view
	Insert the following code fragment:
		C Ethan A Merritt Aug 1994
		C	for Raster3D draw dashed lines as a string of spheres
		      IF (RASTER .AND. (LINDSH(TOTGST).NE.0)) THEN
			CALL GRLIND( COO1, COO2 )
			RETURN
		      END IF

5) Rebuild and re-install Molscript

=============================================================================

NB: These patches are specifically for Molscript version 1.4, if you have 
an earlier version you will need to update it to 1.4 before doing
anything else. Hopefully this code will make its way into some subsequent 
version of Molscript so that patching is not necessary.

				Ethan A Merritt
				August 1996
