<HTML>
<HEAD>
   <TITLE>RASTEP - Raster3D thermal ellipsoid program</TITLE>
</HEAD>
<BODY>

<H1 ALIGN=CENTER> RASTEP </H1>
<H2 ALIGN=CENTER>(Raster3D Thermal Ellipsoid Program)</H2>

<H4>SYNOPSIS</H4>

<PRE>
rastep [-h] [-iso] [-Bcolor Bmin Bmax] [-prob Plevel] [-radius R] 
       [-fancy[0-3]] 
       &lt; infile.pdb &gt; ellipsoids.r3d
</PRE>

<P><B>rastep</B> reads a Brookhaven PDB coordinate file and creates an
input file for the Raster3d <a href="render.html"><B>render</B></a> program. 
Atoms are represented
by ellipsoids enclosing an isosurface of the probability density function
described by the Anisotropic Displacement Parameters Uij, commonly known
as thermal ellipsoids. </P>


<H4> EXAMPLES</H4>

<P>To describe thermal ellipsoids at the 50% probability level, with default
CPK colors, and send it for immediate rendering into a TIFF image file:</P>

<PRE>rastep &lt; infile.pdb | render -tiff picture.tiff
</PRE>

<P>To describe the same ellipsoids colored by Biso, and create an input
module with no header records for inclusion in a composite image:</P>

<PRE>rastep -h -Bcolor 10. 30. &lt; infile.pdb &gt; ellipsoids.r3d
cat header.r3d ellipsoids.r3d otherstuff.r3d | render -tiff picture.tiff
</PRE>

<H4>OPTIONS</H4>

<DL>
<DT><I> -h</I></DT>

<DD>Suppress header records in output. By default <B>rastep</B> will produce
an output file which starts with header records containing a default set
of scaling and processing options. The -h flag will suppress these header
records. This option is useful for producing files which describe only
part of a scene, and which are to be later combined with descriptor files
produced by other programs. </DD>

<DT><I>-iso</I></DT>

<DD>Force isotropic probability surfaces (spheres). By default <B>rastep</B>
will look for 
<a href="pdb_anisou.html"> ANISOU records </a> 
in the PDB file and use these to generate
ellipsoids. If no ANISOU record is present for a given atom, the B value
given in the ATOM record will be used to generate a sphere instead. Selecting
the -iso option will force the program to use the B value in the ATOM record
even if an ANISOU record is also present. </DD>

<DT><I>-Bcolor Bmin Bmax</I></DT>

<DD>Assign colors based on B values rather matching ATOM records against
input or default COLOUR records. Atoms with B &lt;= Bmin will be colored
dark blue; atoms with B &gt;= Bmax will be colored light red; atoms with
Bmin &lt; B &lt; Bmax will be assigned colors shading smoothly through
the spectrum from blue to red. </DD>

<DT><I>-prob Plevel</I></DT>

<DD>By default, isosurfaces are drawn to enclose the 50% probability level
in the probability density function described by the Uij values in the
ANISOU record. The -prob option allows you to select a different probability
level instead. If 0&lt;Plevel&lt;1 this value is interpreted as a fraction;
if Plevel &gt; 1 this value is interpreted as a percent. </DD>

<DT><I>-radius R</I></DT>

<DD>By default, <B>rastep</B> draws bonds with radius 0.10&Aring; between
neighboring atoms using the same algorithm as <B>rods</B>. This option
allows you to change the radius of the bonds. </DD>

<DT><I>-fancy[0-3]</I></DT>

<DD>The -fancy option selects increasingly complex representations of the
rendered ellipsoids (see figure below)  </DD>

<DL>
<DT> -fancy0 [default] solid surface
<DT> -fancy1 draw principal axes of ellipsoid with a transparent bounding
      surface 
<DT> -fancy2 draw colored equatorial planes of the ellipsoid
<DT> -fancy3 draw colored equatorial planes with a transparent bounding
      surface
</DL>

</DL>

<img src="rastep_options.gif" alt="[figure]" hspace=50>

<H4>NOTES</H4>

<P>There is little, if any, consistency in format among the various programs
which write out anisotropic displacement parameters. This program interprets
the Uij values in the order specified for 
<a href="pdb_anisou.html">ANISOU records</a> in PDB format.
That is, columns 29-70 of the PDB record are interpreted as integers representing
10<SUP>4</SUP> &Aring;<SUP>2 </SUP>x Uij , in the order U11, U22, U23,
U12, U13, U23. Note in particular that the order of cross-terms is not
the same as that used by ORTEP or shelx, which do not use PDB format. However,
the program shelxpro will produce correctly formatted PDB records from
a shelx coordinate file.</P>

<H4>AUTHOR</H4>

<P>Ethan A Merritt</P>

<H4>  REFERENCES</H4>

<P>  M.N. Burnett &amp; C.K. Johnson (1996). "ORTEP-III: Oak Ridge thermal
ellipsoid plot program for crystal structure illustrations". ORNL-6895,
Oak Ridge National Laboratory. Table 6.1</P>

<P>  K.N. Trueblood et al (1996). "Atomic Displacement Parameter Nomenclature,
report of a subcommittee on atomic displacement parameter nomenclature".
Acta Cryst. A52, 770-781.</P>


<hr>
<a href="raster3d.html">
<img src="/images/index_button.gif" align=top> Back to top </a>
<a href="http://www.bmsc.washington.edu/raster3d/raster3d.html">
<img src="r3d_icon.gif" alt="" align=top> Raster3D homepage </a>

</body>
</html>
